
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: docs/data_loader.ipynb

import torch

def collate(b):
    xs,ys = zip(*b)
    return torch.stack(xs),torch.stack(ys)
    #glues tensors together on new axis

class DataLoader():
    def __init__(self, ds, sampler, collate_fn=collate):
        self.ds,self.sampler,self.collate_fn = ds,sampler,collate_fn

    def __iter__(self):
        for s in self.sampler: yield self.collate_fn([self.ds[i] for i in s])

    def __len__(self): return len(self.ds)
